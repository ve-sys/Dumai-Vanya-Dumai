import DB
import disnake
from disnake.ext import commands
import random
token=open("info.txt").readline()[6:]
bot = commands.Bot(command_prefix='$', help_command=None, intents=disnake.Intents.all())
prfl= ["–ë–∏–æ—Ö–∏–º","–°–æ—Ü—ç–∫–æ–Ω–æ–º","–§–∏–∑–º–∞—Ç"]
sprfl=['ü¶†','üìã','üî©']
eprfl=['üß¨','üìà','‚öôÔ∏è']
@bot.event
async def on_ready():
    print(f"Device {bot.user} is set and ready to go")
    game = disnake.Game("—Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö")
    await bot.change_presence(status=disnake.Status.online, activity=game)
    global guild
    guild = bot.guilds[0]
    global basedstrE
    global basedstrS
    basedstrE = '''
    üéØ\n1) –í—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –¥–ª—è —Å–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:'''
    basedstrS = '''
    ‚ùî\n1) –í—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –¥–ª—è —Å–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:'''
    for i in range(len(prfl)):
            basedstrE += f'\n{eprfl[i]} - {prfl[i]}'
            basedstrS += f'\n{sprfl[i]} - {prfl[i]}'
    basedstrE+='\n2) –í—ã –º–æ–∂–µ—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≤–æ–∏ —Ç–µ–º—ã –Ω–∞–±—Ä–∞–≤ "/–º–æ—ë" –∏ —É–¥–∞–ª–∏—Ç—å —Ç–µ–º—É –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –Ω–∞–±—Ä–∞–≤ "/—É–¥–∞–ª–∏—Ç—å —Ç–µ–º—É"'
    basedstrS+='''\n2) –í—ã –º–æ–∂–µ—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ç–µ–º—É –Ω–∞–±—Ä–∞–≤ "/–ø—Ä–µ–¥–ª–æ–∂–∏—Çm**"
3) –í—ã –º–æ–∂–µ—Ç–µ —É–¥–∞–ª–∏—Ç—å —Å–µ–±—è –∏–∑ –∞–≤—Ç–æ—Ä–æ–≤ —Ç–µ–º—ã –Ω–∞–±—Ä–∞–≤ "/—É–¥–∞–ª–∏—Ç—å"'''

@bot.event
async def on_message(message):
    print(f'{message.author}|{message.author.id}|{message.content}:')
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ —Å–µ—Ä–≤–∞–∫–µ
    if message.author != bot.user:
        if message.content.startswith('init'):
            mess = '''–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ–º –≤–∞—Å, –¥–æ—Ä–æ–≥–æ–π –¥—Ä—É–≥, –Ω–∞ –Ω–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ!
–° –ø–æ–º–æ—â—å—é –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞ –≤—ã —Å–º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏/–ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ç–µ–º—É –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞.
–ß—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å —Å–≤–æ—é —Ä–æ–ª—å –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Ç–∏–∫–µ—Ä:\n
‚ùî - –ï—Å–ª–∏ –≤—ã –≤ –ø–æ–∏—Å–∫–∞—Ö —Ç–µ–º—ã –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞
üéØ - –ï—Å–ª–∏ –≤—ã –≥–æ—Ç–æ–≤—ã –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∏–¥–µ—é –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—É
\n(–î–ª—è –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–∞–±–æ—Ç–µ –±–æ—Ç–∞ –ø–∏—à–∏—Ç–µ /–ø–æ–º–æ—â—å)'''
            msg = await message.reply(mess)
            await msg.add_reaction('‚ùî')
            await msg.add_reaction('üéØ')
            print(f'{message.author}|{message.author.id}|{message.content}:')

@bot.slash_command(description="–í—ã–¥–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–º–µ")
async def –∏–Ω—Ñ–æ(inter, —Ç–µ–º–∞: str, ):
    await inter.response.send_message(DB.infa_full(—Ç–µ–º–∞))

@bot.slash_command(description="–ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ç–µ–º—É")
async def –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å(inter, —Ç–µ–º–∞: str):
    global guild
    uroles = []
    for x in (guild.get_member(inter.author.id).roles):
        uroles.append(x.name)
    if "–°–æ–∑–¥–∞—Ç–µ–ª–∏ —Ç–µ–º" in uroles:
        msg = —Ç–µ–º–∞
        for h in range(1, len(uroles)):
            if uroles[h] in prfl:
                prf = uroles[h]
        await inter.response.send_message(DB.addtheme(msg, inter.author.id, prf))
    elif "–ò—â—É—â–∏–µ —Ç–µ–º" in uroles:\
        await inter.response.send_message('–í–∞–º –Ω–µ –ø–æ–ª–æ–∂–µ–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–µ–º—É')

@bot.slash_command(description="–£–¥–∞–ª—è–µ—Ç –≤–∞—Å –∏–∑ —Å–æ—Å—Ç–∞–≤–∞ –∞–≤—Ç–æ—Ä—Å–≤ —Ç–µ–º—ã")
async def —É–¥–∞–ª–∏—Ç—å(inter,—Ç–µ–º–∞: str):
    global guild
    uroles = []
    for x in (guild.get_member(inter.author.id).roles):
        uroles.append(x.name)
    if "–°–æ–∑–¥–∞—Ç–µ–ª–∏ —Ç–µ–º" in uroles:
        msg = —Ç–µ–º–∞
        await inter.response.send_message(DB.removetheme(msg, inter.author.id))
    elif "–ò—â—É—â–∏–µ —Ç–µ–º" in uroles:
        tema = —Ç–µ–º–∞
        await inter.response.send_message(DB.follow(tema, inter.author.id, False))

@bot.slash_command(description="–í—ã–¥–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤–∞—à–∏—Ö —Ç–µ–º")
async def –º–æ—ë(inter):
    mess = str((DB.mytheme(inter.author.id))) + \
           '\n–í—ã –º–æ–∂–µ—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –ª—é–±–æ–π —Ç–µ–º–µ –ø—Ä–æ–ø–∏—Å–∞–≤ –∫–æ–º–∞–Ω–¥—É /–∏–Ω—Ñ–æ'
    await inter.response.send_message(mess)

@bot.slash_command(description='–í—ã–∑—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–º–æ—â–∏')
async def –ø–æ–º–æ—â—å(inter):
    mess1 = '''**–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é. –í—ã –≤—ã–∑–≤–∞–ª–∏ —Å–ø—Ä–∞–≤–∫—É –ø–æ —Ä–∞–±–æ—Ç–µ –±–æ—Ç–∞**
Ôªø
–í –Ω–∞—á–∞–ª–µ –≤–∞–º –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –≤—ã–±—Ä–∞—Ç—å —Ä–æ–ª—å
Ôªø:grey_question:Ôªø   –ï—Å–ª–∏ –≤—ã –≤ –ø–æ–∏—Å–∫–∞—Ö —Ç–µ–º—ã –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞
Ôªø:dart:Ôªø   –ï—Å–ª–∏ –≤—ã –≥–æ—Ç–æ–≤ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∏–¥–µ—é –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—É
–†–æ–ª—å –º–æ–∂–Ω–æ —Å–º–µ–Ω–∏—Ç—å –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–±–æ—Ç—ã —Å –±–æ—Ç–æ–º
Ôªø
–î–∞–ª–µ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—Å—è –Ω–∞ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç, –∏ —Ç–µ—Ö, –∫—Ç–æ –∏—â–µ—Ç:'''
    mess2 = '''\n\n**–î–ª—è —Ç–µ—Ö –∫—Ç–æ –∏—â–µ—Ç —Ç–µ–º—É:**
Ôªø
**–í—ã–±–æ—Ä –ø—Ä–æ—Ñ–∏–ª—è:**
–í—ã–±–æ—Ä –ø—Ä–æ—Ñ–∏–ª—è –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ, –ø—Ä–∏—Å–ª–∞–Ω–Ω–æ–µ –±–æ—Ç–æ–º –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ —Ä–æ–ª–∏ 
:microbe:Ôªø- –ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ-—Ö–∏–º–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å 
:clipboard:Ôªø- –°–æ—Ü–∏–∞–ª—å–Ω–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å
:nut_and_bolt:Ôªø - –§–∏–∑–∏–∫–æ-–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å
–ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –ø—Ä–æ—Ñ–∏–ª—è, –±–æ—Ç –±—É–¥–µ—Ç –ø–æ–¥–±–∏—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ —Ç–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥—Ö–æ–¥—è—Ç –ø–æ–¥ –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å
Ôªø
**–¢–µ–º—ã:**
–ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –ø—Ä–æ—Ñ–∏–ª—è, –≤—ã —Å–º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∞—Ç—å —Ç–µ–º—ã
–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤–æ–π —Ç–µ–º—ã –Ω–∞–∂–º–∏—Ç–µ  :arrows_counterclockwise:ÔªøÔªø
–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–µ–º—ã –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ –Ω–∞–∂–º–∏—Ç–µ :star:Ôªø 
**–ö–æ–º–∞–Ω–¥—ã:**
- /–º–æ—ë - –∫–æ–º–∞–Ω–¥–∞ –≤—ã–¥–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –≤–∞–º–∏ —Ç–µ–º –∏ —Ç–µ–º, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
- /—É–¥–∞–ª–∏—Ç—å <...> - –∫–æ–º–∞–Ω–¥–∞ —É–¥–∞–ª—è–µ—Ç —Ç–µ–º—É –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ 
- /–∏–Ω—Ñ–æ <...> - –∫–æ–º–∞–Ω–¥–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–∑–Ω–∞—Ç—å —Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ —Ç–µ–º–µ
'''
    mess3 = '''\n\n **–î–ª—è —Ç–µ—Ö –∫—Ç–æ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ç–µ–º—É:**
Ôªø
**–í—ã–±–æ—Ä –ø—Ä–æ—Ñ–∏–ª—è:**
–í—ã–±–æ—Ä –ø—Ä–æ—Ñ–∏–ª—è –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ, –ø—Ä–∏—Å–ª–∞–Ω–Ω–æ–µ –±–æ—Ç–æ–º –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ —Ä–æ–ª–∏ 
:dna:Ôªø - –ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ-—Ö–∏–º–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å 
:chart_with_upwards_trend:Ôªø - –°–æ—Ü–∏–∞–ª—å–Ω–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å
:gear:Ôªø - –§–∏–∑–∏–∫–æ-–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å
–ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –ø—Ä–æ—Ñ–∏–ª—è, –≤–∞—à–∏ —Ç–µ–º—ã –±—É–¥—É—Ç –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
Ôªø
**–ö–æ–º–∞–Ω–¥—ã:**
- /–ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å <...> - –∫–æ–º–∞–Ω–¥–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø–∏—Å–∞—Ç—å —Ç–µ–º—É –≤ –±–∞–∑—É —Ç–µ–º
- /—É–¥–∞–ª–∏—Ç—å <...> - –∫–æ–º–∞–Ω–¥–∞ —É–¥–∞–ª—è–µ—Ç –≤–∞—à–µ –∞–≤—Ç–æ—Ä—Å—Ç–≤–æ –∏–∑ —Ç–µ–º—ã 
- /–º–æ—ë - –∫–æ–º–∞–Ω–¥–∞ –≤—ã–¥–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –≤–∞–º–∏ —Ç–µ–º –∏ —Ç–µ–º, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
- /–∏–Ω—Ñ–æ <...> - –∫–æ–º–∞–Ω–¥–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–∑–Ω–∞—Ç—å —Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ —Ç–µ–º–µ'''
    await inter.response.send_message(mess1)
    await inter.author.send(mess2)
    await inter.author.send(mess3)

@bot.slash_command(description="–í—ã–¥–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–∞—Ç—á–Ω–æ—É—Ç")
async def –ø–∞—Ç—á(inter):
    mess ='''–ï–∂—É–ø–∞ v.2.0.2
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–ª–µ—à –∫–æ–º–∞–Ω–¥—ã
- –ò–∑–º–µ–Ω–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ help
- –î–æ–±–∞–≤–ª–µ–Ω –º—è–≥–∫–∏–π –∑–Ω–∞–∫ –≤ –∫–æ–º–∞–Ω–¥—É "–ø–æ–º–æ—â", —Ç–µ–ø–µ—Ä—å —ç—Ç–æ "–ø–æ–º–æ—â—å"'''

    await inter.response.send_message(mess)

@bot.event
async def on_raw_reaction_add(date):
    global guild
    print('+' + str(date.emoji))
    # –í—ã–¥–∞–µ—Ç—Å—è —Ä–æ–ª—å –∏—â—É—â–µ–≥–æ –∏–ª–∏ –ø—Ä–µ–¥–ª–∞–≥–∞—é—â–µ–≥–æ
    member = guild.get_member(date.user_id)
    if member != bot.user:
        uroles = []
        for x in (member.roles):
            uroles.append(x.name)
        try:message = await member.fetch_message(date.message_id)
        except:
            if str(date.emoji) == 'üéØ':
                role = disnake.utils.get(guild.roles, name="–°–æ–∑–¥–∞—Ç–µ–ª–∏ —Ç–µ–º")
                role2 = disnake.utils.get(guild.roles, name="–ò—â—É—â–∏–µ —Ç–µ–º")
                print(guild, member)
                await member.add_roles(role)
                await member.remove_roles(role2)
                global prfl
                for i in uroles:
                    if i in prfl:
                        Role = disnake.utils.get(guild.roles, name=i)
                        await member.remove_roles(Role)
                global basedstrE
                mess = basedstrE
                msg = await member.send(mess)
                await msg.add_reaction('üß¨')
                await msg.add_reaction('‚öôÔ∏è')
                await msg.add_reaction('üìà')
            if str(date.emoji) == '‚ùî':
                role = disnake.utils.get(guild.roles, name="–ò—â—É—â–∏–µ —Ç–µ–º")
                role2 = disnake.utils.get(guild.roles, name="–°–æ–∑–¥–∞—Ç–µ–ª–∏ —Ç–µ–º")
                print(guild, member)
                await member.add_roles(role)
                await member.remove_roles(role2)
                global basedstrS
                mess = basedstrS
                msg = await member.send(mess)
                await msg.add_reaction('ü¶†')
                await msg.add_reaction('üî©')
                await msg.add_reaction('üìã')
        print(uroles)
        # –í—ã–¥–∞–µ—Ç—Å—è —Ä–æ–ª—å –ë–∏–æ—Ö–∏–º/–§–∏–∑–º–∞—Ç/–°–æ—Ü—ç–∫ –ø—Ä–µ–¥–ª–∞–≥–∞—é—â–µ–º—É (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω)
        global pseudotheme
        global eprfl
        global sprfl
        if str(date.emoji) in eprfl and member != bot.user and "–°–æ–∑–¥–∞—Ç–µ–ª–∏ —Ç–µ–º" in uroles:
            print(guild, member)
            for l in eprfl:
                if str(date.emoji) == l:
                    role = disnake.utils.get(guild.roles, name=prfl[eprfl.index(str(date.emoji))])
                    await member.add_roles(role)
                    mess = f'–ò—Ç–∞–∫, –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å - {prfl[eprfl.index(str(date.emoji))]}\n–ß—Ç–æ–±—ã –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ç–µ–º—É –Ω–∞–ø–∏—à–∏—Ç–µ "!–ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ç–µ–º—É" \n (–ø—Ä–∏–º–µ—Ä: !–ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ç–µ–º—É **–≤–∞—à–∞ —Ç–µ–º–∞**)'
                    await message.reply(mess)
                    print(l + "send", prfl[eprfl.index(str(date.emoji))])
                else:
                    role2 = disnake.utils.get(guild.roles, name=prfl[eprfl.index(l)])
                    await member.remove_roles(role2)
                    print(l + "los")
                print(member.roles)
        # –í—ã–¥–∞–µ—Ç—Å—è —Ä–æ–ª—å –ë–∏–æ—Ö–∏–º/–§–∏–∑–º–∞—Ç/–°–æ—Ü—ç–∫ –∏—â—É—â–µ–º—É (–≤–æ–∑–º–æ–∂–µ–Ω –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä)
        if "–ò—â—É—â–∏–µ —Ç–µ–º" in uroles and str(date.emoji) in sprfl:
            role = disnake.utils.get(guild.roles, name=prfl[sprfl.index(str(date.emoji))])
            print(guild, member)
            await member.add_roles(role)
            mess = '–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—É—é —Ç–µ–º—É –Ω–∞–∂–º–∏—Ç–µ üîÑ\n–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–º—É –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ –Ω–∞–∂–º–∏—Ç–µ ‚≠ê'
            msg = await message.reply(mess)
            await msg.add_reaction('üîÑ')
        # –í—ã–¥–∞—á–∞ —Ç–µ–º—ã –∏—â—É—â–µ–º—É
        if str(date.emoji) == 'üîÑ':
            if len(uroles) > 2:
                prf = []
                for h in uroles:
                    if h in prfl:
                        prf.append(h)
                tema = DB.gettema(prf,date.user_id)
                if len(tema)>0:
                    print("–î–µ–±–∞–≥ –±–∞–∑—ã")
                    # 1 –∫—Ä–∏—Ç–µ—Ä–∏–π –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
                    min_view = min([int(x[3]) for x in tema])
                    print(min_view)
                    # 2 –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å–∫–≤–æ –∞–≤—Ç–æ—Ä–æ–≤ –¥–ª—è —Ç–µ–º –≥–¥–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ —Ä–∞–≤–Ω–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º—É
                    max_authors = max([x[1].count("@") for x in tema if int(x[3]) == min_view])
                    print(max_authors)
                    # 3 –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ–ª–æ–≤–µ—Ä–æ–≤ –¥–ª—è —Ç–µ–º –≥–¥–µ: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º—É –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–≤—Ç–æ—Ä–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É
                    min_follow = min(
                        [x[2].count("@") for x in tema if int(x[3]) == min_view and x[1].count("@") == max_authors])
                    print(min_follow)
                    # 4 –º–∞—Å—Å–∏–≤ –Ω–∞ –≤—ã—Ö–æ–¥ —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ –∫–æ—Ä—Ç–µ–∂–µ–π —Å—Ç—Ä–æ–∫ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—â–∏—Ö —É—Å–ª–æ–≤–∏—é: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ —Ä–∞–≤–Ω–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º—É, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–≤—Ç–æ—Ä–æ–≤ —Ä–∞–≤–Ω–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ–ª–ª–æ–≤–µ—Ä–æ–≤ —Ä–∞–≤–Ω–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º—É
                    out = [x for x in tema if
                           int(x[3]) == min_view and x[1].count("@") == max_authors and x[2].count("@") == min_follow]
                    # —Ä–∞–Ω–¥–æ–º –∏–∑ —Ç–æ–≥–æ —á—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å
                    mess = random.choice(out)
                    # + –ø—Ä–æ—Å–º–æ—Ç—Ä –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é —Ç–µ–º—É
                    DB.record(mess[0])
                    # –≤—ã–≤–æ–¥
                    msg = await message.reply(mess[0] + " –ü—Ä–µ–¥–ª–æ–∂–∏–ª(–∏):" + mess[1][2:])
                    await msg.add_reaction('üîÑ')
                    await msg.add_reaction('‚≠ê')
                else:
                    await message.reply("–ü–æ–¥—Ö–æ–¥—è—â–∞—è —Ç–µ–º–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")

        if str(date.emoji) == '‚≠ê' and "–ò—â—É—â–∏–µ —Ç–µ–º" in uroles:
            channel = await member.create_dm()
            msg = await channel.fetch_message(date.message_id)
            out=message.content[:msg.content.index(" –ü—Ä–µ–¥–ª–æ–∂–∏–ª(–∏):")]
            print(out)
            await message.reply(DB.follow(out,date.user_id,True))
@bot.event
async def on_raw_reaction_remove(date):
    global guild
    member = guild.get_member(date.user_id)
    uroles = []
    for x in (member.roles):
        uroles.append(x.name)
    print(uroles)
    print('-' + str(date.emoji))
    if member != bot.user:
        if str(date.emoji) == 'üéØ' and "–ò—â—É—â–∏–µ —Ç–µ–º" in uroles:
            role = disnake.utils.get(guild.roles, name="–°–æ–∑–¥–∞—Ç–µ–ª–∏ —Ç–µ–º")
            print(guild, member)
            await member.remove_roles(role)
        if str(date.emoji) == '‚ùî' and "–°–æ–∑–¥–∞—Ç–µ–ª–∏ —Ç–µ–º" in uroles:
            role = disnake.utils.get(guild.roles, name="–ò—â—É—â–∏–µ —Ç–µ–º")
            print(guild, member)
            await member.remove_roles(role)
        if str(date.emoji) == 'üß¨' or str(date.emoji) == 'ü¶†':
            role = disnake.utils.get(guild.roles, name="–ë–∏–æ—Ö–∏–º")
            print(guild, member)
            await member.remove_roles(role)
        if str(date.emoji) == '‚öôÔ∏è' or str(date.emoji) == 'üî©':
            role = disnake.utils.get(guild.roles, name="–§–∏–∑–º–∞—Ç")
            print(guild, member)
            await member.remove_roles(role)
        if str(date.emoji) == 'üìà' or str(date.emoji) == 'üìã':
            role = disnake.utils.get(guild.roles, name="–°–æ—Ü—ç–∫–æ–Ω–æ–º")
            print(guild, member)
            await member.remove_roles(role)
        if str(date.emoji) == '‚≠ê' and "–ò—â—É—â–∏–µ —Ç–µ–º" in uroles:
            channel=await member.create_dm()
            msg=await channel.fetch_message(date.message_id)
            await msg.reply(DB.follow(msg.content,date.user_id,False))
bot.run(token)
